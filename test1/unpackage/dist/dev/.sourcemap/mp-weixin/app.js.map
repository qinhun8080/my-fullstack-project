{"version":3,"file":"app.js","sources":["App.vue","main.js"],"sourcesContent":["<script>\n\tconst API_BASE_URL = 'http://127.0.0.1:8081/api';\n\n\texport default {\n\t\tonLaunch: function() {\n\t\t\tconsole.log('App Launch');\n\t\t\tthis.checkLoginStatus();\n\t\t},\n\t\tmethods: {\n\t\t\tcheckLoginStatus() {\n\t\t\t\t// 1. 先看本地有没有标记为已登录\n\t\t\t\tconst hasLogin = uni.getStorageSync('hasLogin');\n\n\t\t\t\tif (!hasLogin) {\n\t\t\t\t\t// 本地没记录，直接去登录页\n\t\t\t\t\tthis.redirectToLogin();\n\t\t\t\t} else {\n\t\t\t\t\t// 2. (可选但推荐) 调用后端接口确认 Session 是否过期\n\t\t\t\t\t// 因为 Session 可能会在服务器端过期(30分钟)，但前端还存着 hasLogin=true\n\t\t\t\t\tuni.request({\n\t\t\t\t\t\turl: API_BASE_URL + '/session-status',\n\t\t\t\t\t\tmethod: 'GET',\n\t\t\t\t\t\twithCredentials: true, // 必须携带 Cookie\n\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\t// 后端返回: { loggedIn: true/false, userData: ... }\n\t\t\t\t\t\t\tif (res.data && res.data.loggedIn) {\n\t\t\t\t\t\t\t\tconsole.log('Session有效，保持登录状态');\n\t\t\t\t\t\t\t\t// 更新最新的用户信息\n\t\t\t\t\t\t\t\tuni.setStorageSync('userInfo', res.data.userData);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconsole.log('Session已过期，请重新登录');\n\t\t\t\t\t\t\t\t// 清除本地状态并跳转\n\t\t\t\t\t\t\t\tuni.removeStorageSync('hasLogin');\n\t\t\t\t\t\t\t\tuni.removeStorageSync('userInfo');\n\t\t\t\t\t\t\t\tthis.redirectToLogin();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfail: () => {\n\t\t\t\t\t\t\t// 网络错误时，为了安全也建议跳回登录，或者提示用户\n\t\t\t\t\t\t\t// 这里简单处理：不做强制跳转，允许用户离线看缓存界面(如果需要)\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tredirectToLogin() {\n\t\t\t\t// 关闭所有页面，打开登录页\n\t\t\t\tuni.reLaunch({\n\t\t\t\t\turl: '/pages/login/login'\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\">\n\tpage {\n\t\tbackground-color: #f7f8fa;\n\t\tpadding: 20rpx;\n\t\tfont-family: -apple-system, BlinkMacSystemFont, 'Helvetica Neue', Helvetica,\n\t\t\tSegoe UI, Arial, Roboto, 'PingFang SC', 'miui', 'Hiragino Sans GB',\n\t\t\t'Microsoft Yahei', sans-serif;\n\t\tcolor: #333;\n\t\tbox-sizing: border-box;\n\t}\n\n\tview,\n\ttext,\n\timage,\n\tbutton {\n\t\tbox-sizing: border-box;\n\t}\n\n\t.card {\n\t\tbackground-color: #ffffff;\n\t\tborder-radius: 16rpx;\n\t\tpadding: 30rpx;\n\t\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.05);\n\t\tmargin-bottom: 20rpx;\n\t}\n\n\tbutton::after {\n\t\tborder: none;\n\t}\n\t\n\tbutton {\n\t\tpadding: 0;\n\t\tmargin: 0;\n\t\tbackground-color: transparent;\n\t\tline-height: 1.5;\n\t}\n</style>","import App from './App'\n\n// #ifndef VUE3\nimport Vue from 'vue'\nimport './uni.promisify.adaptor'\nVue.config.productionTip = false\nApp.mpType = 'app'\nconst app = new Vue({\n  ...App\n})\napp.$mount()\n// #endif\n\n// #ifdef VUE3\nimport { createSSRApp } from 'vue'\nexport function createApp() {\n  const app = createSSRApp(App)\n  return {\n    app\n  }\n}\n// #endif"],"names":["uni","createSSRApp","App"],"mappings":";;;;;;;;;;;AACC,MAAM,eAAe;AAErB,MAAK,YAAU;AAAA,EACd,UAAU,WAAW;AACpBA,kBAAAA,MAAA,MAAA,OAAA,gBAAY,YAAY;AACxB,SAAK,iBAAgB;AAAA,EACrB;AAAA,EACD,SAAS;AAAA,IACR,mBAAmB;AAElB,YAAM,WAAWA,cAAAA,MAAI,eAAe,UAAU;AAE9C,UAAI,CAAC,UAAU;AAEd,aAAK,gBAAe;AAAA,aACd;AAGNA,sBAAAA,MAAI,QAAQ;AAAA,UACX,KAAK,eAAe;AAAA,UACpB,QAAQ;AAAA,UACR,iBAAiB;AAAA;AAAA,UACjB,SAAS,CAAC,QAAQ;AAEjB,gBAAI,IAAI,QAAQ,IAAI,KAAK,UAAU;AAClCA,4BAAAA,MAAY,MAAA,OAAA,iBAAA,kBAAkB;AAE9BA,4BAAG,MAAC,eAAe,YAAY,IAAI,KAAK,QAAQ;AAAA,mBAC1C;AACNA,4BAAAA,MAAY,MAAA,OAAA,iBAAA,kBAAkB;AAE9BA,kCAAI,kBAAkB,UAAU;AAChCA,kCAAI,kBAAkB,UAAU;AAChC,mBAAK,gBAAe;AAAA,YACrB;AAAA,UACA;AAAA,UACD,MAAM,MAAM;AAAA,UAGZ;AAAA,QACD,CAAC;AAAA,MACF;AAAA,IACA;AAAA,IACD,kBAAkB;AAEjBA,oBAAAA,MAAI,SAAS;AAAA,QACZ,KAAK;AAAA,MACN,CAAC;AAAA,IACF;AAAA,EACD;AACD;ACpCM,SAAS,YAAY;AAC1B,QAAM,MAAMC,cAAY,aAACC,SAAG;AAC5B,SAAO;AAAA,IACL;AAAA,EACD;AACH;;;"}