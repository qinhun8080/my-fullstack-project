{"version":3,"file":"login.js","sources":["pages/login/login.vue","C:/Users/30302/Documents/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<view class=\"login-card\">\r\n\t\t\t<view class=\"header\">\r\n\t\t\t\t<text class=\"title\">欢迎登录</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"form-area\">\r\n\r\n\t\t\t\t<view class=\"input-group\">\r\n\t\t\t\t\t<text class=\"label\">用户名</text>\r\n\t\t\t\t\t<view class=\"input-wrapper\">\r\n\t\t\t\t\t\t<input class=\"input-field\" v-model=\"username\" placeholder=\"请输入用户名\"\r\n\t\t\t\t\t\t\tplaceholder-class=\"placeholder-style\" />\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<view class=\"input-group\">\r\n\t\t\t\t\t<text class=\"label\">密码</text>\r\n\t\t\t\t\t<view class=\"input-wrapper\">\r\n\t\t\t\t\t\t<input class=\"input-field\" :password=\"!showPassword\" v-model=\"password\" placeholder=\"请输入密码\"\r\n\t\t\t\t\t\t\tplaceholder-class=\"placeholder-style\" />\r\n\t\t\t\t\t\t<view class=\"password-toggle\" @click=\"togglePasswordVisibility\">\r\n\t\t\t\t\t\t\t<uni-icons :type=\"showPassword ? 'eye-filled' : 'eye-slash-filled'\" size=\"20\"\r\n\t\t\t\t\t\t\t\tcolor=\"#c0c4cc\"></uni-icons>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<view class=\"options-grid\">\r\n\t\t\t\t\t<view class=\"remember-me\">\r\n\t\t\t\t\t\t<checkbox-group @change=\"handleCheckboxChange\">\r\n\t\t\t\t\t\t\t<label class=\"checkbox-label\">\r\n\t\t\t\t\t\t\t\t<checkbox value=\"1\" :checked=\"rememberMe\" style=\"transform:scale(0.7)\"\r\n\t\t\t\t\t\t\t\t\tcolor=\"#1890FF\" />\r\n\t\t\t\t\t\t\t\t<text class=\"checkbox-text\">记住我</text>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t</checkbox-group>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"forgot-link\" @click=\"goToForgotPassword\">\r\n\t\t\t\t\t\t<text>忘记密码？</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<button class=\"login-btn\" @click=\"handleLogin\" :disabled=\"loggingIn\" :class=\"{loading: loggingIn}\">\r\n\t\t\t\t\t{{ loggingIn ? '登 录 中...' : '登 录' }}\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<view class=\"footer-links\">\r\n\t\t\t\t\t<text class=\"footer-link\" @click=\"goToRegister\">注册账号</text>\r\n\t\t\t\t\t<view class=\"footer-btn\" @click=\"showPasswordTip\">\r\n\t\t\t\t\t\t<uni-icons type=\"star\" size=\"14\" color=\"#1890FF\"></uni-icons>\r\n\t\t\t\t\t\t<text class=\"footer-link\">密码建议</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\t// 确保 IP 地址正确\r\n\tconst API_BASE_URL = 'http://127.0.0.1:8081/api';\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tusername: '',\r\n\t\t\t\tpassword: '',\r\n\t\t\t\tloggingIn: false,\r\n\t\t\t\tshowPassword: false,\r\n\t\t\t\trememberMe: false\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\ttogglePasswordVisibility() {\r\n\t\t\t\tthis.showPassword = !this.showPassword;\r\n\t\t\t},\r\n\t\t\thandleCheckboxChange(e) {\r\n\t\t\t\t// 你的原有逻辑：判断数组长度\r\n\t\t\t\tthis.rememberMe = e.detail.value.length > 0;\r\n\t\t\t\tconsole.log('记住我状态:', this.rememberMe);\r\n\t\t\t},\r\n\t\t\tshowPasswordTip() {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '密码建议功能开发中',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\thandleLogin() {\r\n\t\t\t\tif (!this.username || !this.password) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '请输入账号和密码',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.loggingIn = true;\r\n\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: API_BASE_URL + '/login',\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t// [原有逻辑已恢复] 保持 Session/Cookie 传递能力\r\n\t\t\t\t\twithCredentials: true,\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t// 显式指定 JSON，防止部分环境默认表单提交\r\n\t\t\t\t\t\t'content-type': 'application/json'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tusername: this.username,\r\n\t\t\t\t\t\tpassword: this.password,\r\n\t\t\t\t\t\t// [原有逻辑已恢复] 传递记住我状态\r\n\t\t\t\t\t\trememberMe: this.rememberMe\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log('登录结果:', res.data);\r\n\t\t\t\t\t\tif (res.data && res.data.success) {\r\n\r\n\t\t\t\t\t\t\t// 1. [新增] 必须存储 Token 才能让后续接口鉴权通过\r\n\t\t\t\t\t\t\tif (res.data.token) {\r\n\t\t\t\t\t\t\t\tuni.setStorageSync('token', res.data.token);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// 2. 你的原有存储逻辑\r\n\t\t\t\t\t\t\tuni.setStorageSync('hasLogin', true);\r\n\t\t\t\t\t\t\tuni.setStorageSync('userInfo', res.data.userData);\r\n\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '登录成功',\r\n\t\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\t\t\t\turl: '/pages/index/index'\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: res.data.message || '登录失败',\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('请求失败:', err);\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '无法连接服务器',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tthis.loggingIn = false;\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tgoToRegister() {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/pages/login/register'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tgoToForgotPassword() {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/pages/login/forgot-password'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t/* 复制上方 Forgot Password 页面的样式，保持风格完全一致 */\r\n\t.container {\r\n\t\tmin-height: 100vh;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tbackground: #f0f2f5;\r\n\t\tposition: relative;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.login-card {\r\n\t\tbackground: rgba(255, 255, 255, 0.98);\r\n\t\twidth: 90%;\r\n\t\tmax-width: 680rpx;\r\n\t\tpadding: 60rpx 50rpx;\r\n\t\tborder-radius: 24rpx;\r\n\t\tbox-shadow: 0 20rpx 60rpx rgba(0, 0, 0, 0.06);\r\n\t\tz-index: 1;\r\n\t}\r\n\r\n\t.header {\r\n\t\tmargin-bottom: 50rpx;\r\n\t\ttext-align: left;\r\n\t}\r\n\r\n\t.title {\r\n\t\tfont-size: 48rpx;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #333;\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\r\n\t.input-group {\r\n\t\tmargin-bottom: 40rpx;\r\n\t}\r\n\r\n\t.label {\r\n\t\tdisplay: block;\r\n\t\tmargin-bottom: 16rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tfont-weight: 600;\r\n\t\tcolor: #606266;\r\n\t}\r\n\r\n\t/* --- 优化后的输入框 --- */\r\n\t.input-wrapper {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tbackground: #f5f7fa;\r\n\t\t/* 明显但不突兀的背景 */\r\n\t\tborder: 2rpx solid #e4e7ed;\r\n\t\t/* 柔和边框 */\r\n\t\tborder-radius: 12rpx;\r\n\t\tpadding: 0 24rpx;\r\n\t\theight: 100rpx;\r\n\t\ttransition: all 0.3s;\r\n\t}\r\n\r\n\t.input-wrapper:focus-within {\r\n\t\tbackground: #fff;\r\n\t\tborder-color: #1890FF;\r\n\t\tbox-shadow: 0 0 0 6rpx rgba(24, 144, 255, 0.1);\r\n\t}\r\n\r\n\t.input-field {\r\n\t\tflex: 1;\r\n\t\theight: 100%;\r\n\t\tfont-size: 30rpx;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.placeholder-style {\r\n\t\tcolor: #c0c4cc;\r\n\t}\r\n\r\n\t.options-grid {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tmargin-bottom: 50rpx;\r\n\t}\r\n\r\n\t.checkbox-label {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.checkbox-text {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #666;\r\n\t\tmargin-left: 10rpx;\r\n\t}\r\n\r\n\t.forgot-link text {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #1890FF;\r\n\t}\r\n\r\n\t.login-btn {\r\n\t\tbackground: linear-gradient(135deg, #3B9DFF 0%, #1890FF 100%);\r\n\t\tcolor: white;\r\n\t\tfont-size: 34rpx;\r\n\t\tfont-weight: 600;\r\n\t\tborder-radius: 50rpx;\r\n\t\theight: 100rpx;\r\n\t\tline-height: 100rpx;\r\n\t\tbox-shadow: 0 10rpx 20rpx rgba(24, 144, 255, 0.3);\r\n\t\tborder: none;\r\n\t\ttransition: transform 0.1s;\r\n\t}\r\n\r\n\t.login-btn:active {\r\n\t\ttransform: scale(0.98);\r\n\t\topacity: 0.9;\r\n\t}\r\n\r\n\t.footer-links {\r\n\t\tmargin-top: 40rpx;\r\n\t\ttext-align: center;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\tgap: 30rpx;\r\n\t}\r\n\r\n\t.footer-link {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #1890FF;\r\n\t\tfont-weight: 600;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 6rpx;\r\n\t}\r\n</style>","import MiniProgramPage from 'D:/my-fullstack-project/test1/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AA+DC,MAAM,eAAe;AAErB,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,UAAU;AAAA,MACV,UAAU;AAAA,MACV,WAAW;AAAA,MACX,cAAc;AAAA,MACd,YAAY;AAAA,IACb;AAAA,EACA;AAAA,EACD,SAAS;AAAA,IACR,2BAA2B;AAC1B,WAAK,eAAe,CAAC,KAAK;AAAA,IAC1B;AAAA,IACD,qBAAqB,GAAG;AAEvB,WAAK,aAAa,EAAE,OAAO,MAAM,SAAS;AAC1CA,oBAAA,MAAA,MAAA,OAAA,+BAAY,UAAU,KAAK,UAAU;AAAA,IACrC;AAAA,IACD,kBAAkB;AACjBA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,MAAM;AAAA,MACP,CAAC;AAAA,IACD;AAAA,IACD,cAAc;AACb,UAAI,CAAC,KAAK,YAAY,CAAC,KAAK,UAAU;AACrCA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACP,CAAC;AACD;AAAA,MACD;AAEA,WAAK,YAAY;AAEjBA,oBAAAA,MAAI,QAAQ;AAAA,QACX,KAAK,eAAe;AAAA,QACpB,QAAQ;AAAA;AAAA,QAER,iBAAiB;AAAA,QACjB,QAAQ;AAAA;AAAA,UAEP,gBAAgB;AAAA,QAChB;AAAA,QACD,MAAM;AAAA,UACL,UAAU,KAAK;AAAA,UACf,UAAU,KAAK;AAAA;AAAA,UAEf,YAAY,KAAK;AAAA,QACjB;AAAA,QACD,SAAS,CAAC,QAAQ;AACjBA,2EAAY,SAAS,IAAI,IAAI;AAC7B,cAAI,IAAI,QAAQ,IAAI,KAAK,SAAS;AAGjC,gBAAI,IAAI,KAAK,OAAO;AACnBA,4BAAG,MAAC,eAAe,SAAS,IAAI,KAAK,KAAK;AAAA,YAC3C;AAGAA,0BAAAA,MAAI,eAAe,YAAY,IAAI;AACnCA,0BAAG,MAAC,eAAe,YAAY,IAAI,KAAK,QAAQ;AAEhDA,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO;AAAA,cACP,MAAM;AAAA,YACP,CAAC;AAED,uBAAW,MAAM;AAChBA,4BAAAA,MAAI,UAAU;AAAA,gBACb,KAAK;AAAA,cACN,CAAC;AAAA,YACD,GAAE,GAAI;AAAA,iBACD;AACNA,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO,IAAI,KAAK,WAAW;AAAA,cAC3B,MAAM;AAAA,YACP,CAAC;AAAA,UACF;AAAA,QACA;AAAA,QACD,MAAM,CAAC,QAAQ;AACdA,wBAAc,MAAA,MAAA,SAAA,gCAAA,SAAS,GAAG;AAC1BA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO;AAAA,YACP,MAAM;AAAA,UACP,CAAC;AAAA,QACD;AAAA,QACD,UAAU,MAAM;AACf,eAAK,YAAY;AAAA,QACjB;AAAA,MACF,CAAC;AAAA,IACD;AAAA,IACD,eAAe;AACdA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,MACN,CAAC;AAAA,IACD;AAAA,IACD,qBAAqB;AACpBA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,MACN,CAAC;AAAA,IACD;AAAA,EACF;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxKD,GAAG,WAAW,eAAe;"}