{"version":3,"file":"forgot-password.js","sources":["pages/login/forgot-password.vue","C:/Users/30302/Documents/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4vZm9yZ290LXBhc3N3b3JkLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <view class=\"login-card\">\n      <view class=\"header\">\n        <text class=\"title\">安全重置</text>\n      </view>\n\n      <view class=\"form-area\">\n        \n        <view class=\"input-group\">\n          <text class=\"label\">用户名</text>\n          <input \n            class=\"input-field\" \n            v-model=\"form.username\" \n            placeholder=\"请输入您的用户名\" \n            placeholder-class=\"placeholder-style\" \n          />\n        </view>\n\n        <view class=\"input-group\">\n          <text class=\"label\">预留手机号</text>\n          <input \n            class=\"input-field\" \n            v-model=\"form.phone\" \n            type=\"number\"\n            maxlength=\"11\"\n            placeholder=\"请输入注册时绑定的手机号\" \n            placeholder-class=\"placeholder-style\" \n          />\n        </view>\n\n        <view class=\"input-group\">\n          <text class=\"label\">新密码</text>\n          <view class=\"password-wrapper\">\n            <input \n              class=\"input-field\" \n              :password=\"!showPassword\" \n              v-model=\"form.newPassword\" \n              placeholder=\"请输入新密码\" \n              placeholder-class=\"placeholder-style\" \n            />\n            <view class=\"password-toggle\" @click=\"showPassword = !showPassword\">\n              <uni-icons :type=\"showPassword ? 'eye-filled' : 'eye-slash-filled'\" size=\"20\" color=\"#6b7280\"></uni-icons>\n            </view>\n          </view>\n        </view>\n\n        <view class=\"input-group\">\n          <text class=\"label\">确认新密码</text>\n          <view class=\"password-wrapper\">\n            <input \n              class=\"input-field\" \n              :password=\"!showConfirmPassword\" \n              v-model=\"form.confirmPassword\" \n              placeholder=\"请再次输入新密码\" \n              placeholder-class=\"placeholder-style\" \n            />\n            <view class=\"password-toggle\" @click=\"showConfirmPassword = !showConfirmPassword\">\n              <uni-icons :type=\"showConfirmPassword ? 'eye-filled' : 'eye-slash-filled'\" size=\"20\" color=\"#6b7280\"></uni-icons>\n            </view>\n          </view>\n        </view>\n\n        <button \n          class=\"login-btn\" \n          @click=\"handleReset\" \n          :disabled=\"isSubmitting\" \n          :class=\"{loading: isSubmitting}\"\n        >\n          {{ isSubmitting ? '重置中...' : '确认重置' }}\n        </button>\n\n        <view class=\"footer-links\">\n          <text class=\"footer-link\" @click=\"goBackLogin\">\n             返回登录\n          </text>\n        </view>\n\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\n  const API_BASE_URL = 'http://127.0.0.1:8081/api';\n\n  export default {\n    data() {\n      return {\n        form: {\n          username: '',\n          phone: '',\n          newPassword: '',\n          confirmPassword: ''\n        },\n        showPassword: false,\n        showConfirmPassword: false,\n        isSubmitting: false\n      }\n    },\n    methods: {\n      goBackLogin() {\n        uni.navigateBack();\n      },\n      handleReset() {\n        // 1. 前端校验\n        if (!this.form.username || !this.form.phone) {\n          uni.showToast({ title: '请填写用户名和手机号', icon: 'none' });\n          return;\n        }\n        if (!this.form.newPassword || !this.form.confirmPassword) {\n          uni.showToast({ title: '请输入并确认新密码', icon: 'none' });\n          return;\n        }\n        if (this.form.newPassword !== this.form.confirmPassword) {\n          uni.showToast({ title: '两次输入的密码不一致', icon: 'none' });\n          return;\n        }\n\n        this.isSubmitting = true;\n\n        // 2. 发起请求\n        uni.request({\n          url: API_BASE_URL + '/user/reset-password',\n          method: 'POST',\n          data: {\n            username: this.form.username,\n            phone: this.form.phone,\n            newPassword: this.form.newPassword\n          },\n          success: (res) => {\n            if (res.data && res.data.success) {\n              uni.showToast({ title: '重置成功', icon: 'success' });\n              \n              // 延迟 1.5秒后返回登录页\n              setTimeout(() => {\n                uni.navigateBack();\n              }, 1500);\n            } else {\n              uni.showToast({\n                title: res.data.message || '重置失败',\n                icon: 'none',\n                duration: 3000 // 错误信息多停留一会\n              });\n            }\n          },\n          fail: () => {\n            uni.showToast({ title: '连接服务器失败', icon: 'none' });\n          },\n          complete: () => {\n            this.isSubmitting = false;\n          }\n        });\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\" scoped>\n  /* * 直接复用 Login.vue 的样式 \n   * 确保风格完全一致\n   */\n  .container {\n    min-height: 100vh;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    background-color: #f0f2f5; \n    padding: 20rpx;\n  }\n\n  .login-card {\n    background: #ffffff;\n    width: 100%;\n    max-width: 650rpx;\n    padding: 60rpx 40rpx;\n    border-radius: 24rpx;\n    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);\n  }\n\n  .header {\n    margin-bottom: 40rpx;\n    text-align: center;\n  }\n\n  .title {\n    font-size: 40rpx;\n    font-weight: bold;\n    color: #111827;\n  }\n\n  .input-group {\n    margin-bottom: 30rpx;\n  }\n\n  .label {\n    display: block;\n    margin-bottom: 12rpx;\n    font-size: 28rpx;\n    font-weight: 500;\n    color: #6b7280;\n  }\n\n  .input-field {\n    width: 100%;\n    height: 90rpx;\n    padding: 0 20rpx;\n    border: 2rpx solid #d1d5db;\n    border-radius: 12rpx;\n    font-size: 30rpx;\n    color: #333;\n    box-sizing: border-box;\n    background-color: #fff;\n  }\n\n  .placeholder-style {\n    color: #9ca3af;\n  }\n\n  .password-wrapper {\n    position: relative;\n    width: 100%;\n  }\n\n  .password-toggle {\n    position: absolute;\n    right: 20rpx;\n    top: 50%;\n    transform: translateY(-50%);\n    z-index: 10;\n    padding: 10rpx;\n  }\n\n  .login-btn {\n    background-color: #6366f1;\n    color: white;\n    font-size: 32rpx;\n    font-weight: 600;\n    border-radius: 16rpx;\n    height: 96rpx;\n    line-height: 96rpx;\n    border: none;\n    margin-top: 20rpx; /* 调整间距 */\n    margin-bottom: 30rpx;\n    transition: opacity 0.2s;\n\n    &:active {\n      opacity: 0.9;\n    }\n    &.loading {\n      opacity: 0.7;\n    }\n  }\n\n  .footer-links {\n    display: flex;\n    justify-content: center;\n    margin-top: 10rpx;\n  }\n\n  .footer-link {\n    font-size: 28rpx;\n    color: #6366f1;\n    font-weight: 500;\n  }\n</style>","import MiniProgramPage from 'D:/大创/test1/pages/login/forgot-password.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AAoFE,MAAM,eAAe;AAErB,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,MAAM;AAAA,QACJ,UAAU;AAAA,QACV,OAAO;AAAA,QACP,aAAa;AAAA,QACb,iBAAiB;AAAA,MAClB;AAAA,MACD,cAAc;AAAA,MACd,qBAAqB;AAAA,MACrB,cAAc;AAAA,IAChB;AAAA,EACD;AAAA,EACD,SAAS;AAAA,IACP,cAAc;AACZA,oBAAG,MAAC,aAAY;AAAA,IACjB;AAAA,IACD,cAAc;AAEZ,UAAI,CAAC,KAAK,KAAK,YAAY,CAAC,KAAK,KAAK,OAAO;AAC3CA,sBAAG,MAAC,UAAU,EAAE,OAAO,cAAc,MAAM,OAAO,CAAC;AACnD;AAAA,MACF;AACA,UAAI,CAAC,KAAK,KAAK,eAAe,CAAC,KAAK,KAAK,iBAAiB;AACxDA,sBAAG,MAAC,UAAU,EAAE,OAAO,aAAa,MAAM,OAAK,CAAG;AAClD;AAAA,MACF;AACA,UAAI,KAAK,KAAK,gBAAgB,KAAK,KAAK,iBAAiB;AACvDA,sBAAG,MAAC,UAAU,EAAE,OAAO,cAAc,MAAM,OAAO,CAAC;AACnD;AAAA,MACF;AAEA,WAAK,eAAe;AAGpBA,oBAAAA,MAAI,QAAQ;AAAA,QACV,KAAK,eAAe;AAAA,QACpB,QAAQ;AAAA,QACR,MAAM;AAAA,UACJ,UAAU,KAAK,KAAK;AAAA,UACpB,OAAO,KAAK,KAAK;AAAA,UACjB,aAAa,KAAK,KAAK;AAAA,QACxB;AAAA,QACD,SAAS,CAAC,QAAQ;AAChB,cAAI,IAAI,QAAQ,IAAI,KAAK,SAAS;AAChCA,0BAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,UAAQ,CAAG;AAGhD,uBAAW,MAAM;AACfA,4BAAG,MAAC,aAAY;AAAA,YACjB,GAAE,IAAI;AAAA,iBACF;AACLA,0BAAAA,MAAI,UAAU;AAAA,cACZ,OAAO,IAAI,KAAK,WAAW;AAAA,cAC3B,MAAM;AAAA,cACN,UAAU;AAAA;AAAA,YACZ,CAAC;AAAA,UACH;AAAA,QACD;AAAA,QACD,MAAM,MAAM;AACVA,wBAAG,MAAC,UAAU,EAAE,OAAO,WAAW,MAAM,OAAK,CAAG;AAAA,QACjD;AAAA,QACD,UAAU,MAAM;AACd,eAAK,eAAe;AAAA,QACtB;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1JF,GAAG,WAAW,eAAe;"}