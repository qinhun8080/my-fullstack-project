{"version":3,"file":"register.js","sources":["pages/login/register.vue","C:/Users/30302/Documents/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4vcmVnaXN0ZXIudnVl"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <view class=\"register-card\">\n      <view class=\"header\">\n        <text class=\"title\">用户注册</text>\n      </view>\n\n      <view class=\"form-area\">\n        \n        <view class=\"input-group\">\n          <text class=\"label\">账号 <text class=\"required\">*</text></text>\n          <input class=\"input-field\" v-model=\"form.username\" placeholder=\"设置您的账号\" placeholder-class=\"placeholder-style\" />\n        </view>\n\n        <view class=\"input-group\">\n          <text class=\"label\">昵称</text>\n          <input class=\"input-field\" v-model=\"form.nickname\" placeholder=\"怎么称呼您 (选填)\" placeholder-class=\"placeholder-style\" />\n        </view>\n\n        <view class=\"input-group\">\n          <text class=\"label\">性别</text>\n          <picker @change=\"bindGenderChange\" :value=\"genderIndex\" :range=\"genderOptions\" range-key=\"label\">\n            <view class=\"input-field picker-view\" :class=\"{ empty: !genderText }\">\n              {{ genderText || '请选择性别' }}\n            </view>\n          </picker>\n        </view>\n\n        <view class=\"input-group\">\n          <text class=\"label\">出生日期</text>\n          <picker mode=\"date\" :value=\"form.birthday\" start=\"1900-01-01\" end=\"2030-12-31\" @change=\"bindDateChange\">\n            <view class=\"input-field picker-view\" :class=\"{ empty: !form.birthday }\">\n              {{ form.birthday || '请选择出生日期' }}\n            </view>\n          </picker>\n        </view>\n\n        <view class=\"input-group\">\n          <text class=\"label\">手机号码</text>\n          <input class=\"input-field\" type=\"number\" maxlength=\"11\" v-model=\"form.phone\" placeholder=\"方便找回密码 (选填)\" placeholder-class=\"placeholder-style\" />\n        </view>\n\n        <view class=\"input-group\">\n          <text class=\"label\">密码 <text class=\"required\">*</text></text>\n          <view class=\"password-wrapper\">\n            <input class=\"input-field\" :password=\"!showPassword\" v-model=\"form.password\" placeholder=\"设置密码\" placeholder-class=\"placeholder-style\" />\n            <view class=\"password-toggle\" @click=\"showPassword = !showPassword\">\n              <uni-icons :type=\"showPassword ? 'eye-filled' : 'eye-slash-filled'\" size=\"20\" color=\"#6b7280\"></uni-icons>\n            </view>\n          </view>\n        </view>\n\n        <view class=\"input-group\">\n          <text class=\"label\">确认密码 <text class=\"required\">*</text></text>\n          <view class=\"password-wrapper\">\n            <input class=\"input-field\" :password=\"!showConfirmPassword\" v-model=\"form.confirmPassword\" placeholder=\"请再次输入密码\" placeholder-class=\"placeholder-style\" />\n            <view class=\"password-toggle\" @click=\"showConfirmPassword = !showConfirmPassword\">\n              <uni-icons :type=\"showConfirmPassword ? 'eye-filled' : 'eye-slash-filled'\" size=\"20\" color=\"#6b7280\"></uni-icons>\n            </view>\n          </view>\n        </view>\n\n        <button class=\"register-btn\" @click=\"handleUserRegister\" :disabled=\"isSubmitting\" :class=\"{loading: isSubmitting}\">\n          {{ isSubmitting ? '正在注册...' : '注 册' }}\n        </button>\n\n        <view class=\"footer-links\">\n          <text class=\"footer-text\">已有账号？</text>\n          <text class=\"footer-link\" @click=\"goToLogin\">去登录</text>\n        </view>\n\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\n  const API_BASE_URL = 'http://127.0.0.1:8081/api';\n\n  export default {\n    data() {\n      return {\n        form: {\n          username: '',\n          nickname: '',\n          gender: '', // 传给后端的数值 (1, 0, 2)\n          birthday: '',\n          phone: '',\n          password: '',\n          confirmPassword: ''\n        },\n        // 性别选择器配置\n        genderOptions: [\n          { label: '男', value: 1 },\n          { label: '女', value: 0 },\n          { label: '其他', value: 2 }\n        ],\n        genderIndex: -1, // picker 的索引\n        genderText: '', // 显示在输入框的文字\n\n        showPassword: false,\n        showConfirmPassword: false,\n        isSubmitting: false\n      }\n    },\n    methods: {\n      goToLogin() {\n        uni.navigateBack(); \n      },\n\n      // 处理性别选择\n      bindGenderChange(e) {\n        this.genderIndex = e.detail.value;\n        const selected = this.genderOptions[this.genderIndex];\n        this.genderText = selected.label;\n        this.form.gender = selected.value; // 保存 1, 0, 2 到表单\n      },\n\n      // 处理日期选择\n      bindDateChange(e) {\n        this.form.birthday = e.detail.value; // YYYY-MM-DD\n      },\n\n      handleUserRegister() {\n        if (!this.form.username) return uni.showToast({ title: '请输入账号', icon: 'none' });\n        if (!this.form.password) return uni.showToast({ title: '请输入密码', icon: 'none' });\n        if (this.form.password !== this.form.confirmPassword) {\n          return uni.showToast({ title: '两次密码不一致', icon: 'none' });\n        }\n\n        this.isSubmitting = true;\n\n        uni.request({\n          url: API_BASE_URL + '/user/register',\n          method: 'POST',\n          data: {\n            username: this.form.username,\n            nickname: this.form.nickname,\n            gender: this.form.gender === '' ? null : this.form.gender, // 确保空值传null\n            birthday: this.form.birthday,\n            phone: this.form.phone,\n            password: this.form.password\n          },\n          success: (res) => {\n            if (res.data && res.data.success) {\n              uni.showToast({ title: '注册成功', icon: 'success' });\n              setTimeout(() => { this.goToLogin(); }, 1500);\n            } else {\n              uni.showToast({ title: res.data.message || '注册失败', icon: 'none' });\n            }\n          },\n          fail: (err) => {\n            console.error(err);\n            uni.showToast({ title: '网络请求失败', icon: 'none' });\n          },\n          complete: () => {\n            this.isSubmitting = false;\n          }\n        });\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\" scoped>\n  /* 全局容器 */\n  .container {\n    min-height: 100vh;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    background-color: #f0f2f5;\n    padding: 20rpx;\n  }\n\n  .register-card {\n    background: #ffffff;\n    width: 100%;\n    max-width: 650rpx;\n    padding: 60rpx 40rpx;\n    border-radius: 24rpx;\n    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);\n  }\n\n  .header { margin-bottom: 40rpx; text-align: center; }\n  .title { font-size: 40rpx; font-weight: bold; color: #111827; }\n\n  .input-group { margin-bottom: 30rpx; }\n  .label { display: block; margin-bottom: 12rpx; font-size: 28rpx; font-weight: 500; color: #6b7280; }\n  .required { color: #ef4444; margin-left: 4rpx; }\n\n  /* 输入框样式 */\n  .input-field {\n    width: 100%;\n    height: 90rpx;\n    padding: 0 20rpx;\n    border: 2rpx solid #d1d5db;\n    border-radius: 12rpx;\n    font-size: 30rpx;\n    color: #333;\n    box-sizing: border-box;\n    background-color: #fff;\n    /* 垂直居中 */\n    display: flex;\n    align-items: center; \n  }\n\n  /* 模拟 picker 的输入框样式 */\n  .picker-view {\n    justify-content: flex-start;\n  }\n  .picker-view.empty {\n    color: #9ca3af; /* 与 placeholder 颜色一致 */\n  }\n\n  .placeholder-style { color: #9ca3af; }\n\n  .password-wrapper { position: relative; width: 100%; }\n  .password-toggle {\n    position: absolute; right: 20rpx; top: 50%; transform: translateY(-50%); z-index: 10; padding: 10rpx;\n  }\n\n  .register-btn {\n    background-color: #6366f1; color: white; font-size: 32rpx; font-weight: 600; border-radius: 16rpx; height: 96rpx; line-height: 96rpx; border: none; margin-top: 40rpx; margin-bottom: 30rpx; transition: opacity 0.2s;\n  }\n  .register-btn:active { opacity: 0.9; }\n  .register-btn.loading { opacity: 0.7; }\n\n  .footer-links { display: flex; justify-content: center; align-items: center; gap: 10rpx; margin-top: 10rpx; }\n  .footer-text { font-size: 28rpx; color: #6b7280; }\n  .footer-link { font-size: 28rpx; color: #6366f1; font-weight: 600; }\n</style>","import MiniProgramPage from 'D:/my-fullstack-project/test1/pages/login/register.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AA6EE,MAAM,eAAe;AAErB,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,MAAM;AAAA,QACJ,UAAU;AAAA,QACV,UAAU;AAAA,QACV,QAAQ;AAAA;AAAA,QACR,UAAU;AAAA,QACV,OAAO;AAAA,QACP,UAAU;AAAA,QACV,iBAAiB;AAAA,MAClB;AAAA;AAAA,MAED,eAAe;AAAA,QACb,EAAE,OAAO,KAAK,OAAO,EAAG;AAAA,QACxB,EAAE,OAAO,KAAK,OAAO,EAAG;AAAA,QACxB,EAAE,OAAO,MAAM,OAAO,EAAE;AAAA,MACzB;AAAA,MACD,aAAa;AAAA;AAAA,MACb,YAAY;AAAA;AAAA,MAEZ,cAAc;AAAA,MACd,qBAAqB;AAAA,MACrB,cAAc;AAAA,IAChB;AAAA,EACD;AAAA,EACD,SAAS;AAAA,IACP,YAAY;AACVA,oBAAG,MAAC,aAAY;AAAA,IACjB;AAAA;AAAA,IAGD,iBAAiB,GAAG;AAClB,WAAK,cAAc,EAAE,OAAO;AAC5B,YAAM,WAAW,KAAK,cAAc,KAAK,WAAW;AACpD,WAAK,aAAa,SAAS;AAC3B,WAAK,KAAK,SAAS,SAAS;AAAA,IAC7B;AAAA;AAAA,IAGD,eAAe,GAAG;AAChB,WAAK,KAAK,WAAW,EAAE,OAAO;AAAA,IAC/B;AAAA,IAED,qBAAqB;AACnB,UAAI,CAAC,KAAK,KAAK;AAAU,eAAOA,cAAG,MAAC,UAAU,EAAE,OAAO,SAAS,MAAM,OAAQ,CAAA;AAC9E,UAAI,CAAC,KAAK,KAAK;AAAU,eAAOA,cAAG,MAAC,UAAU,EAAE,OAAO,SAAS,MAAM,OAAQ,CAAA;AAC9E,UAAI,KAAK,KAAK,aAAa,KAAK,KAAK,iBAAiB;AACpD,eAAOA,cAAAA,MAAI,UAAU,EAAE,OAAO,WAAW,MAAM,OAAO,CAAC;AAAA,MACzD;AAEA,WAAK,eAAe;AAEpBA,oBAAAA,MAAI,QAAQ;AAAA,QACV,KAAK,eAAe;AAAA,QACpB,QAAQ;AAAA,QACR,MAAM;AAAA,UACJ,UAAU,KAAK,KAAK;AAAA,UACpB,UAAU,KAAK,KAAK;AAAA,UACpB,QAAQ,KAAK,KAAK,WAAW,KAAK,OAAO,KAAK,KAAK;AAAA;AAAA,UACnD,UAAU,KAAK,KAAK;AAAA,UACpB,OAAO,KAAK,KAAK;AAAA,UACjB,UAAU,KAAK,KAAK;AAAA,QACrB;AAAA,QACD,SAAS,CAAC,QAAQ;AAChB,cAAI,IAAI,QAAQ,IAAI,KAAK,SAAS;AAChCA,0BAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,UAAQ,CAAG;AAChD,uBAAW,MAAM;AAAE,mBAAK,UAAS;AAAA,eAAO,IAAI;AAAA,iBACvC;AACLA,0BAAAA,MAAI,UAAU,EAAE,OAAO,IAAI,KAAK,WAAW,QAAQ,MAAM,OAAO,CAAC;AAAA,UACnE;AAAA,QACD;AAAA,QACD,MAAM,CAAC,QAAQ;AACbA,wBAAAA,MAAc,MAAA,SAAA,mCAAA,GAAG;AACjBA,wBAAG,MAAC,UAAU,EAAE,OAAO,UAAU,MAAM,OAAK,CAAG;AAAA,QAChD;AAAA,QACD,UAAU,MAAM;AACd,eAAK,eAAe;AAAA,QACtB;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChKF,GAAG,WAAW,eAAe;"}